<!DOCTYPE html>
<html lang="es">
<head>
	<meta charset="utf-8" />
	<title>SMIL3 - Registro de un nuevo usuario</title>
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<meta name="description" content="SMIL3" />
	<meta name="author" content="David Gonzalez, Tony Marín" />
	<link href="css/bootstrap.css" rel="stylesheet" />
	<link href="css/bootstrap-responsive.css" rel="stylesheet" />
	<link rel="shortcut icon" href="images/favicon.ico" />
	<!--[if lt IE 9]>
		<script src="html5shim.googlecode.com/svn/trunk/html5.js"></script>
	<![endif]-->
	<style>

		body {
			background-color: #97CAF3; /* rgba(82, 168, 236, 0.6); */
			background-image: -moz-radial-gradient(50% 50%, circle cover, #fff, #97CAF3 100%);
			background-image: -webkit-radial-gradient(50% 50%, circle cover, #fff, #97CAF3 100%);
			background-image: -o-radial-gradient(50% 50%, circle cover, #fff, #97CAF3 100%);
			background-image: -ms-radial-gradient(50% 50%, circle cover, #fff, #97CAF3 100%);
			background-image: radial-gradient(50% 50%, circle cover, #fff, #97CAF3 100%);
			background-attachment: fixed;
		}

		textarea[readonly] {
			cursor: default;
			background-color: #fff;
		}

		.modal {
			position: relative;
			top: auto;
			left: auto;
			margin: 30px auto 10px;
			max-width: 100%;
			max-height: 100%;
		}
		
		.popover {
			z-index: 9999;
		}
		
		.popover-title {
			display: none;
		}
		
		.progress {
			margin-bottom: 0;
		}
		
		.progress .bar {
			background-image: -moz-linear-gradient(top, rgba(255, 255, 255, 0.25), rgba(0, 0, 0, 0.15));
			background-image: -webkit-gradient(linear, 0 0, 0 100%, from(rgba(255, 255, 255, 0.25)), to(rgba(0, 0, 0, 0.15)));
			background-image: -webkit-linear-gradient(top, rgba(255, 255, 255, 0.25), rgba(0, 0, 0, 0.15));
			background-image: -o-linear-gradient(top, rgba(255, 255, 255, 0.25), rgba(0, 0, 0, 0.15));
			background-image: linear-gradient(to bottom, rgba(255, 255, 255, 0.25), rgba(0, 0, 0, 0.15));
			background-repeat: repeat-x;
			filter: progid:dximagetransform.microsoft.gradient(startColorstr='#ffffff19', endColorstr='#00000010', GradientType=0);
		}
		
		#passInfo {
			margin-bottom: 5px;
		}

	</style>
</head>

<body>
	<div class="container">
		<form id="regForm" class="form-horizontal" method="post" action="main.php?do=special&amp;that=register">
		<div class="modal">
			<div class="modal-header">
				<h3>Crea tu cuenta de SMIL3</h3>
			</div>
			<div class="modal-body" style="max-height:initial">
				
					<div class="control-group">
						<label class="control-label" for="username">Nombre de usuario</label>
						<div class="controls">
							<input type="text" class="input-xlarge" name="username" rel="popover" placeholder="=)" required="required" autofocus="autofocus" maxlength="25" data-content="Un nombre que te identifique.<br />Puedes utilizar letras, numeros y algunos simbolos." />
						</div>
					</div>
					<div class="control-group">
						<label class="control-label" for="email">E-mail</label>
						<div class="controls">
							<input type="email" class="input-xlarge" name="email" rel="popover" required="required" data-content="Direccion de correo electronico que usas normalmente." />
						</div>
					</div>
					<div class="control-group">
						<label class="control-label" for="password">Contraseña</label>
						<div class="controls">
							<input type="password" class="input-xlarge" id="p1" name="password" maxlength="25" required="required" oninput="validatePass(this);" />
						</div>
					</div>
					<div class="control-group">
						<label class="control-label" for="password2">Confirmar contraseña</label>
						<div class="controls">
							<input type="password" class="input-xlarge" name="password2" required="required" oninput="validatePassConfirm(document.getElementById('p1'), this);" />
						</div>
					</div>
					<hr />
					<div class="control-group">
						<label class="control-label" for="name">Nombre y apellidos</label>
						<div class="controls">
							<input type="text" class="input-xlarge" name="name" rel="popover" required="required" data-content="Nombre y apellido(s) reales separados por un espacio." />
						</div>
					</div>
					<div class="control-group">
						<label class="control-label" for="sex">Sexo</label>
						<div class="controls">
							<label class="radio"><input type="radio" name="sex" value="M" required="required" />Hombre</label>
							<label class="radio"><input type="radio" name="sex" value="F" required="required" />Mujer</label>
						</div>
					</div>
					
					<div class="control-group">
						<label class="control-label" for="country">Pais</label>
						<div class="controls">
							<select name="country" rel="popover" data-content="Tu pais o territorio de residencia" required="required" ><option value="4">Afganistán</option><option value="8">Albania</option><option value="276">Alemania</option><option value="20">Andorra</option><option value="24">Angola</option><option value="660">Anguila</option><option value="28">Antigua y Barbuda</option><option value="530">Antillas Neerlandesas</option><option value="682">Arabia Saudí</option><option value="12">Argelia</option><option value="32">Argentina</option><option value="51">Armenia</option><option value="533">Aruba</option><option value="36">Australia</option><option value="40">Austria</option><option value="31">Azerbaiyán</option><option value="44">Bahamas</option><option value="48">Bahréin</option><option value="50">Bangladesh</option><option value="52">Barbados</option><option value="56">Bélgica</option><option value="84">Belice</option><option value="204">Benín</option><option value="60">Bermudas</option><option value="112">Bielorrusia</option><option value="68">Bolivia</option><option value="70">Bosnia-Herzegovina</option><option value="72">Botsuana</option><option value="76">Brasil</option><option value="96">Brunéi</option><option value="100">Bulgaria</option><option value="854">Burkina Faso</option><option value="108">Burundi</option><option value="64">Bután</option><option value="132">Cabo Verde</option><option value="116">Camboya</option><option value="120">Camerún</option><option value="124">Canadá</option><option value="148">Chad</option><option value="152">Chile</option><option value="156">China</option><option value="196">Chipre</option><option value="336">Ciudad del Vaticano</option><option value="170">Colombia</option><option value="180">Congo, República Democrática del</option><option value="408">Corea del Norte</option><option value="410">Corea del Sur</option><option value="384">Costa de Marfil</option><option value="188">Costa Rica</option><option value="191">Croacia</option><option value="192">Cuba</option><option value="208">Dinamarca</option><option value="212">Dominica</option><option value="218">Ecuador</option><option value="818">Egipto</option><option value="222">El Salvador</option><option value="784">Emiratos Árabes Unidos</option><option value="232">Eritrea</option><option value="703">Eslovaquia</option><option value="705">Eslovenia</option><option selected="selected" value="ES">España</option><option value="840">Estados Unidos</option><option value="233">Estonia</option><option value="608">Filipinas</option><option value="246">Finlandia</option><option value="242">Fiyi</option><option value="250">Francia</option><option value="266">Gabón</option><option value="270">Gambia</option><option value="268">Georgia</option><option value="288">Ghana</option><option value="292">Gibraltar</option><option value="308">Granada</option><option value="300">Grecia</option><option value="304">Groenlandia</option><option value="312">Guadalupe</option><option value="316">Guam</option><option value="320">Guatemala</option><option value="254">Guayana Francesa</option><option value="324">Guinea</option><option value="226">Guinea Ecuatorial</option><option value="624">Guinea-Bissau</option><option value="328">Guyana</option><option value="332">Haití</option><option value="340">Honduras</option><option value="344">Hong Kong</option><option value="348">Hungría</option><option value="356">India</option><option value="360">Indonesia</option><option value="364">Irán</option><option value="368">Iraq</option><option value="372">Irlanda</option><option value="162">Isla Christmas</option><option value="833">Isla de Man</option><option value="570">Isla Niue</option><option value="574">Isla Norfolk</option><option value="352">Islandia</option><option value="248">Islas Åland</option><option value="136">Islas Caimán</option><option value="166">Islas Cocos</option><option value="184">Islas Cook</option><option value="239">Islas Georgia del Sur y Sandwich del Sur</option><option value="238">Islas Malvinas</option><option value="580">Islas Marianas del Norte</option><option value="584">Islas Marshall</option><option value="612">Islas Pitcairn</option><option value="90">Islas Salomón</option><option value="796">Islas Turcas y Caicos</option><option value="92">Islas Vírgenes Británicas</option><option value="850">Islas Vírgenes de los Estados Unidos</option><option value="376">Israel</option><option value="380">Italia</option><option value="388">Jamaica</option><option value="392">Japón</option><option value="832">Jersey</option><option value="400">Jordania</option><option value="398">Kazajistán</option><option value="404">Kenia</option><option value="417">Kirguistán</option><option value="296">Kiribati</option><option value="414">Kuwait</option><option value="418">Laos</option><option value="426">Lesoto</option><option value="428">Letonia</option><option value="422">Líbano</option><option value="430">Liberia</option><option value="434">Libia</option><option value="438">Liechtenstein</option><option value="440">Lituania</option><option value="442">Luxemburgo</option><option value="446">Macao</option><option value="807">Macedonia</option><option value="450">Madagascar</option><option value="458">Malasia</option><option value="454">Malaui</option><option value="462">Maldivas</option><option value="466">Mali</option><option value="470">Malta</option><option value="504">Marruecos</option><option value="474">Martinica</option><option value="480">Mauricio</option><option value="175">Mayotte</option><option value="484">México</option><option value="583">Micronesia</option><option value="498">Moldavia</option><option value="496">Mongolia</option><option value="499">Montenegro</option><option value="508">Mozambique</option><option value="104">Myanmar</option><option value="516">Namibia</option><option value="520">Nauru</option><option value="524">Nepal</option><option value="558">Nicaragua</option><option value="562">Níger</option><option value="566">Nigeria</option><option value="578">Noruega</option><option value="540">Nueva Caledonia</option><option value="554">Nueva Zelanda</option><option value="512">Omán</option><option value="528">Países Bajos</option><option value="586">Pakistán</option><option value="591">Panamá</option><option value="598">Papúa Nueva Guinea</option><option value="600">Paraguay</option><option value="604">Perú</option><option value="258">Polinesia Francesa</option><option value="616">Polonia</option><option value="620">Portugal</option><option value="630">Puerto Rico</option><option value="634">Qatar</option><option value="826">Reino Unido</option><option value="140">República Centroafricana</option><option value="203">República Checa</option><option value="214">República Dominicana</option><option value="638">Reunión</option><option value="646">Ruanda</option><option value="642">Rumanía</option><option value="643">Rusia</option><option value="732">Sáhara Occidental</option><option value="652">Saint Barthelemy</option><option value="663">Saint Martin</option><option value="882">Samoa</option><option value="16">Samoa Americana</option><option value="659">San Cristóbal y Nieves</option><option value="674">San Marino</option><option value="666">San Pedro y Miquelón</option><option value="670">San Vicente y las Granadinas</option><option value="654">Santa Elena</option><option value="662">Santa Lucía</option><option value="678">Santo Tomé y Príncipe</option><option value="686">Senegal</option><option value="688">Serbia</option><option value="690">Seychelles</option><option value="694">Sierra Leona</option><option value="702">Singapur</option><option value="760">Siria</option><option value="706">Somalia</option><option value="144">Sri Lanka</option><option value="748">Suazilandia</option><option value="710">Sudáfrica</option><option value="736">Sudán</option><option value="752">Suecia</option><option value="756">Suiza</option><option value="740">Surinam</option><option value="764">Tailandia</option><option value="158">Taiwán</option><option value="834">Tanzania</option><option value="762">Tayikistán</option><option value="86">Territorio Británico del Océano Índico</option><option value="275">Territorios Palestinos</option><option value="626">Timor Oriental</option><option value="768">Togo</option><option value="772">Tokelau</option><option value="776">Tonga</option><option value="780">Trinidad y Tobago</option><option value="788">Túnez</option><option value="795">Turkmenistán</option><option value="792">Turquía</option><option value="798">Tuvalu</option><option value="804">Ucrania</option><option value="800">Uganda</option><option value="858">Uruguay</option><option value="860">Uzbekistán</option><option value="548">Vanuatu</option><option value="862">Venezuela</option><option value="704">Vietnam</option><option value="876">Wallis y Futuna</option><option value="887">Yemen</option><option value="262">Yibuti</option><option value="894">Zambia</option><option value="716">Zimbabue</option></select>
						</div>
					</div>
					
					<div class="control-group">
						<label class="control-label" for="birthdate">Fecha de nacimiento</label>
						<div class="controls">
							<select id="birthdate_day" class="inline span1" name="birthdate_day" ><option>Día</option><option value="01">1</option><option value="02">2</option><option value="03">3</option><option value="04">4</option><option value="05">5</option><option value="06">6</option><option value="07">7</option><option value="08">8</option><option value="09">9</option><option value="10">10</option><option value="11">11</option><option value="12">12</option><option value="13">13</option><option value="14">14</option><option value="15">15</option><option value="16">16</option><option value="17">17</option><option value="18">18</option><option value="19">19</option><option value="20">20</option><option value="21">21</option><option value="22">22</option><option value="23">23</option><option value="24">24</option><option value="25">25</option><option value="26">26</option><option value="27">27</option><option value="28">28</option><option value="29">29</option><option value="30">30</option><option value="31">31</option></select>
							<select id="birthdate_month" class="inline span2" name="birthdate_month"><option>Mes</option><option value="01">Enero</option><option value="02">Febrero</option><option value="03">Marzo</option><option value="04">Abril</option><option value="05">Mayo</option><option value="06">Junio</option><option value="07">Julio</option><option value="08">Agosto</option><option value="09">Septiembre</option><option value="10">Octubre</option><option value="11">Noviembre</option><option value="12">Diciembre</option></select>
							<select id="birthdate_year" class="inline span1" name="birthdate_year"><option>Año</option><option value="1998">1998</option><option value="1997">1997</option><option value="1996">1996</option><option value="1995">1995</option><option value="1994">1994</option><option value="1993">1993</option><option value="1992">1992</option><option value="1991">1991</option><option value="1990">1990</option><option value="1989">1989</option><option value="1988">1988</option><option value="1987">1987</option><option value="1986">1986</option><option value="1985">1985</option><option value="1984">1984</option><option value="1983">1983</option><option value="1982">1982</option><option value="1981">1981</option><option value="1980">1980</option><option value="1979">1979</option><option value="1978">1978</option><option value="1977">1977</option><option value="1976">1976</option><option value="1975">1975</option><option value="1974">1974</option><option value="1973">1973</option><option value="1972">1972</option><option value="1971">1971</option><option value="1970">1970</option><option value="1969">1969</option><option value="1968">1968</option><option value="1967">1967</option><option value="1966">1966</option><option value="1965">1965</option><option value="1964">1964</option><option value="1963">1963</option><option value="1962">1962</option><option value="1961">1961</option><option value="1960">1960</option><option value="1959">1959</option><option value="1958">1958</option><option value="1957">1957</option><option value="1956">1956</option><option value="1955">1955</option><option value="1954">1954</option><option value="1953">1953</option><option value="1952">1952</option><option value="1951">1951</option><option value="1950">1950</option><option value="1949">1949</option><option value="1948">1948</option><option value="1947">1947</option><option value="1946">1946</option><option value="1945">1945</option><option value="1944">1944</option><option value="1943">1943</option><option value="1942">1942</option><option value="1941">1941</option><option value="1940">1940</option><option value="1939">1939</option><option value="1938">1938</option><option value="1937">1937</option><option value="1936">1936</option><option value="1935">1935</option><option value="1934">1934</option><option value="1933">1933</option><option value="1932">1932</option><option value="1931">1931</option><option value="1930">1930</option><option value="1929">1929</option><option value="1928">1928</option><option value="1927">1927</option><option value="1926">1926</option><option value="1925">1925</option><option value="1924">1924</option><option value="1923">1923</option><option value="1922">1922</option><option value="1921">1921</option><option value="1920">1920</option><option value="1919">1919</option><option value="1918">1918</option><option value="1917">1917</option><option value="1916">1916</option><option value="1915">1915</option><option value="1914">1914</option><option value="1913">1913</option><option value="1912">1912</option></select>
						</div>
					</div>
					
					<hr />
					<div class="control-group">
						<label class="control-label" for="TOS">Aviso legal</label>
						<div class="controls">
							<textarea class="input-xlarge" id="TOS" rows="5" readonly="readonly" />
En cumplimiento de lo dispuesto en la Ley Orgánica 15/1999, de 13 de diciembre, de Protección de Datos de Carácter Personal y su normativa de desarrollo, queremos informarle de que los datos recabados serán incorporados a un fichero propiedad de SMIL3 con la finalidad de poder gestionar técnicamente los diferentes servicios puestos a su disposición, así como mantenerle informado de nuestras novedades, eventos, ofertas y servicios.
Podrá ejercer, en cualquier momento, sus derechos de acceso, rectificación, cancelación y oposición al tratamiento de sus datos, en los términos previstos legalmente en esta web.</textarea>
						</div>
					</div>
					<div class="control-group">
						<label class="control-label" for="aceptTOS"></label>
						<div class="controls">
							<label class="checkbox">
								<input type="checkbox" name="aceptTOS" value="aceptTOS" required="required" />
								He leído y acepto las condiciones
							</label>
						</div>
					</div>
				
			</div>
			<div class="modal-footer">
				<input type="submit" value="Registrarme" class="btn btn-primary btn-large" data-loading-text="Enviando..." />
				<a href="index.htm" class="btn">Cancelar</a>
			</div>
		</div>
		</form>

	</div>

	<script src="js/jquery-1.8.2.min.js"></script> 
	<script src="js/bootstrap.min.js"></script> 
	<script>
		
	function checkPassword(P)
	{
		var len = P.length;

		var F = len * 2;

		if (P.match(/[a-z]/))
			F += 2;

		if (P.match(/[A-Z]/))
			F += 10;

		if (P.match(/\d+/))
			F += 10;

		if (P.match(/(.*[0-9].*[0-9].*[0-9])/))
			F += 14;

		if (P.match(/.[!,@,#,$,%,^,&,*,?,_,~]/))
			F += 10;

		if (P.match(/(.*[!,@,#,$,%,^,&,*,?,_,~].*[!,@,#,$,%,^,&,*,?,_,~])/))
			F += 14;

		if (P.match(/([a-z].*[A-Z])|([A-Z].*[a-z])/))
			F += 4;

		if (P.match(/([a-zA-Z])/) && P.match(/([0-9])/))
			F += 6;

		if (P.match(/([a-zA-Z0-9].*[!,@,#,$,%,^,&,*,?,_,~])|([!,@,#,$,%,^,&,*,?,_,~].*[a-zA-Z0-9])/))
			F += 6;

		return F > 100 ? 100 : F;
	}
		
	function validatePassConfirm(p1, p2)
	{
		p2.setCustomValidity(p1.value != p2.value ? 'Las contraseñas deben coincidir.' : '');
	}
	
	var validatePass_msg = ['Muy debil', 'Debil', 'Aceptable', 'Segura', 'Muy segura', 'Demasiado segura', 'Corta. Mínimo 6 caracteres.'];
	var validatePass_colors = ['#DD514C', '#FAA732', '#5EB95E', '#5EB95E', '#4BB1CF', '#0E90D2', '#ccc'];
	
	function validatePass(p1)
	{
		var nPerc = checkPassword(p1.value);
		var state = p1.value.length >= 6 ? Math.floor(nPerc / 20) : 6;
		
		$('#passMeter').css({width: nPerc+'%', backgroundColor: validatePass_colors[state]});
		$('#passInfo').html(validatePass_msg[state]);
		
		p1.setCustomValidity(state == 6 ? 'Contraseña demasiado corta.' : '');
	}
	
	function validatePassContent()
	{
		var p1 = document.getElementById('p1');
		var nPerc = checkPassword(p1.value);
		var state = p1.value.length >= 6 ? Math.floor(nPerc / 20) : 6;
		p1.setCustomValidity(state == 6 ? 'Contraseña demasiado corta.' : '');
		return '<div id="passInfo">'+validatePass_msg[state]+'</div><div class="progress"><div id="passMeter" class="bar bar-danger" style="width: '+nPerc+'%;background-color:'+validatePass_colors[state]+'"></div></div>';
	}

	$(document).ready(function() {
		
		$('[rel=popover]').popover({'trigger':'focus', 'placement':'right' });
		$('#p1').popover({'trigger':'focus', 'placement':'right', 'content': validatePassContent });
		
		var regBtn = $('input[type="submit"]');
		regBtn.button();

		$('#regForm').submit(function() {
			regBtn.button('loading');

			// TODO: validar datos.

			$.ajaxSetup({ cache: false });

			var data = $("#regForm").serialize();

			$.post('main.php?do=special&that=register', data, function(data, status, jqXHR)
			{
				/*if (data === '0')
					window.location = 'login.htm';*/

				$('<div class="alert alert-error span11"><button type="button" class="close" data-dismiss="alert">×</button>'+data+'</div>').appendTo($('.container'));
			}, 'text')
			.error(function() { alert("error"); })
			.complete(function() {
				regBtn.button('reset');
			});


			// Evitamos que se envie por el metodo tradicional.
			return false; 
		});
	});
	</script>
</body>
</html>
